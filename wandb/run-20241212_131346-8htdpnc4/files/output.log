  0%|                                                                                                                                | 0/1000 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
/home/sohampoddar/anaconda3/envs/dl/lib/python3.9/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
  2%|██▏                                                                                                                    | 18/1000 [00:14<11:55,  1.37it/s][codecarbon INFO @ 13:14:02] Energy consumed for RAM : 0.000196 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:14:02] Energy consumed for all GPUs : 0.001710 kWh. Total GPU Power : 410.32718457751935 W
[codecarbon INFO @ 13:14:02] Energy consumed for all CPUs : 0.000252 kWh. Total CPU Power : 60.39800566504831 W
[codecarbon INFO @ 13:14:02] 0.002158 kWh of electricity used since the beginning.
  4%|████▋                                                                                                                  | 39/1000 [00:29<11:30,  1.39it/s][codecarbon INFO @ 13:14:17] Energy consumed for RAM : 0.000392 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:14:17] Energy consumed for all GPUs : 0.003483 kWh. Total GPU Power : 425.67685103604794 W
[codecarbon INFO @ 13:14:17] Energy consumed for all CPUs : 0.000504 kWh. Total CPU Power : 60.61337059659503 W
[codecarbon INFO @ 13:14:17] 0.004380 kWh of electricity used since the beginning.
  6%|███████▏                                                                                                               | 60/1000 [00:44<11:12,  1.40it/s][codecarbon INFO @ 13:14:32] Energy consumed for RAM : 0.000588 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:14:32] Energy consumed for all GPUs : 0.005268 kWh. Total GPU Power : 428.5159019977039 W
[codecarbon INFO @ 13:14:32] Energy consumed for all CPUs : 0.000757 kWh. Total CPU Power : 60.66338954234972 W
[codecarbon INFO @ 13:14:32] 0.006613 kWh of electricity used since the beginning.
  8%|█████████▋                                                                                                             | 81/1000 [00:59<10:52,  1.41it/s][codecarbon INFO @ 13:14:47] Energy consumed for RAM : 0.000784 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:14:47] Energy consumed for all GPUs : 0.007053 kWh. Total GPU Power : 428.39366874325 W
[codecarbon INFO @ 13:14:47] Energy consumed for all CPUs : 0.001010 kWh. Total CPU Power : 60.76290829529644 W
[codecarbon INFO @ 13:14:47] 0.008847 kWh of electricity used since the beginning.
 10%|████████████                                                                                                          | 102/1000 [01:14<10:42,  1.40it/s][codecarbon INFO @ 13:15:02] Energy consumed for RAM : 0.000980 kWh. RAM Power : 47.068857192993164 W
{'loss': 1.7569, 'grad_norm': 4.950313568115234, 'learning_rate': 9.7e-05, 'epoch': 0.2}
[codecarbon INFO @ 13:15:02] Energy consumed for all GPUs : 0.008836 kWh. Total GPU Power : 428.1837390718937 W
[codecarbon INFO @ 13:15:02] Energy consumed for all CPUs : 0.001263 kWh. Total CPU Power : 60.69985408486453 W
[codecarbon INFO @ 13:15:02] 0.011080 kWh of electricity used since the beginning.
 12%|██████████████▌                                                                                                       | 123/1000 [01:29<10:29,  1.39it/s][codecarbon INFO @ 13:15:17] Energy consumed for RAM : 0.001176 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:15:17] Energy consumed for all GPUs : 0.010623 kWh. Total GPU Power : 429.01008054733677 W
[codecarbon INFO @ 13:15:17] Energy consumed for all CPUs : 0.001516 kWh. Total CPU Power : 60.790881841476974 W
[codecarbon INFO @ 13:15:17] 0.013316 kWh of electricity used since the beginning.
 14%|████████████████▉                                                                                                     | 144/1000 [01:44<10:10,  1.40it/s][codecarbon INFO @ 13:15:32] Energy consumed for RAM : 0.001372 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:15:32] Energy consumed for all GPUs : 0.012415 kWh. Total GPU Power : 430.1296960651389 W
[codecarbon INFO @ 13:15:32] Energy consumed for all CPUs : 0.001769 kWh. Total CPU Power : 60.67185841535769 W
[codecarbon INFO @ 13:15:32] 0.015556 kWh of electricity used since the beginning.
 16%|███████████████████▎                                                                                                  | 164/1000 [01:59<10:02,  1.39it/s][codecarbon INFO @ 13:15:47] Energy consumed for RAM : 0.001568 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:15:47] Energy consumed for all GPUs : 0.014211 kWh. Total GPU Power : 431.2881336503196 W
[codecarbon INFO @ 13:15:47] Energy consumed for all CPUs : 0.002022 kWh. Total CPU Power : 60.63197866747852 W
[codecarbon INFO @ 13:15:47] 0.017802 kWh of electricity used since the beginning.
 18%|█████████████████████▊                                                                                                | 185/1000 [02:14<09:40,  1.40it/s][codecarbon INFO @ 13:16:02] Energy consumed for RAM : 0.001764 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:16:02] Energy consumed for all GPUs : 0.016006 kWh. Total GPU Power : 431.516590852852 W
[codecarbon INFO @ 13:16:02] Energy consumed for all CPUs : 0.002274 kWh. Total CPU Power : 60.631512471835094 W
[codecarbon INFO @ 13:16:02] 0.020045 kWh of electricity used since the beginning.
 21%|████████████████████████▍                                                                                             | 207/1000 [02:29<09:16,  1.42it/s][codecarbon INFO @ 13:16:17] Energy consumed for RAM : 0.001960 kWh. RAM Power : 47.068857192993164 W
{'loss': 1.4508, 'grad_norm': 4.891898155212402, 'learning_rate': 8.922222222222223e-05, 'epoch': 0.4}
[codecarbon INFO @ 13:16:17] Energy consumed for all GPUs : 0.017789 kWh. Total GPU Power : 428.0190271024418 W
[codecarbon INFO @ 13:16:17] Energy consumed for all CPUs : 0.002525 kWh. Total CPU Power : 60.04519635640916 W
[codecarbon INFO @ 13:16:17] 0.022274 kWh of electricity used since the beginning.
 23%|██████████████████████████▉                                                                                           | 228/1000 [02:44<09:03,  1.42it/s][codecarbon INFO @ 13:16:32] Energy consumed for RAM : 0.002156 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:16:32] Energy consumed for all GPUs : 0.019502 kWh. Total GPU Power : 411.3562324606389 W
[codecarbon INFO @ 13:16:32] Energy consumed for all CPUs : 0.002778 kWh. Total CPU Power : 60.750280396507335 W
[codecarbon INFO @ 13:16:32] 0.024436 kWh of electricity used since the beginning.
 25%|█████████████████████████████▍                                                                                        | 249/1000 [02:59<08:50,  1.41it/s][codecarbon INFO @ 13:16:47] Energy consumed for RAM : 0.002352 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:16:47] Energy consumed for all GPUs : 0.021209 kWh. Total GPU Power : 409.76578426769225 W
[codecarbon INFO @ 13:16:47] Energy consumed for all CPUs : 0.003031 kWh. Total CPU Power : 60.8351708159033 W
[codecarbon INFO @ 13:16:47] 0.026593 kWh of electricity used since the beginning.
 27%|███████████████████████████████▊                                                                                      | 270/1000 [03:14<08:41,  1.40it/s][codecarbon INFO @ 13:17:02] Energy consumed for RAM : 0.002548 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:17:02] Energy consumed for all GPUs : 0.022918 kWh. Total GPU Power : 410.2790686238051 W
[codecarbon INFO @ 13:17:02] Energy consumed for all CPUs : 0.003284 kWh. Total CPU Power : 60.79198801950285 W
[codecarbon INFO @ 13:17:02] 0.028751 kWh of electricity used since the beginning.
 29%|██████████████████████████████████▎                                                                                   | 291/1000 [03:29<08:22,  1.41it/s][codecarbon INFO @ 13:17:17] Energy consumed for RAM : 0.002744 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:17:17] Energy consumed for all GPUs : 0.024635 kWh. Total GPU Power : 412.35918753169017 W
[codecarbon INFO @ 13:17:17] Energy consumed for all CPUs : 0.003537 kWh. Total CPU Power : 60.743853479361704 W
[codecarbon INFO @ 13:17:17] 0.030917 kWh of electricity used since the beginning.
 31%|████████████████████████████████████▊                                                                                 | 312/1000 [03:44<08:11,  1.40it/s][codecarbon INFO @ 13:17:32] Energy consumed for RAM : 0.002940 kWh. RAM Power : 47.068857192993164 W
{'loss': 1.4175, 'grad_norm': 4.151031494140625, 'learning_rate': 7.811111111111111e-05, 'epoch': 0.6}
[codecarbon INFO @ 13:17:32] Energy consumed for all GPUs : 0.026349 kWh. Total GPU Power : 411.4579502246074 W
[codecarbon INFO @ 13:17:32] Energy consumed for all CPUs : 0.003790 kWh. Total CPU Power : 60.633871077131076 W
[codecarbon INFO @ 13:17:32] 0.033080 kWh of electricity used since the beginning.
 33%|███████████████████████████████████████▎                                                                              | 333/1000 [03:59<07:54,  1.41it/s][codecarbon INFO @ 13:17:47] Energy consumed for RAM : 0.003136 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:17:47] Energy consumed for all GPUs : 0.028070 kWh. Total GPU Power : 413.08858451049554 W
[codecarbon INFO @ 13:17:47] Energy consumed for all CPUs : 0.004043 kWh. Total CPU Power : 60.60924202725533 W
[codecarbon INFO @ 13:17:47] 0.035249 kWh of electricity used since the beginning.
 35%|█████████████████████████████████████████▊                                                                            | 354/1000 [04:14<07:36,  1.42it/s][codecarbon INFO @ 13:18:02] Energy consumed for RAM : 0.003333 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:18:03] Energy consumed for all GPUs : 0.029785 kWh. Total GPU Power : 411.1589783847407 W
[codecarbon INFO @ 13:18:03] Energy consumed for all CPUs : 0.004295 kWh. Total CPU Power : 60.593648314832166 W
[codecarbon INFO @ 13:18:03] 0.037413 kWh of electricity used since the beginning.
 38%|████████████████████████████████████████████▎                                                                         | 375/1000 [04:29<07:36,  1.37it/s][codecarbon INFO @ 13:18:17] Energy consumed for RAM : 0.003529 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:18:17] Energy consumed for all GPUs : 0.031466 kWh. Total GPU Power : 403.88707905241745 W
[codecarbon INFO @ 13:18:17] Energy consumed for all CPUs : 0.004547 kWh. Total CPU Power : 60.29515289031948 W
[codecarbon INFO @ 13:18:18] 0.039541 kWh of electricity used since the beginning.
 40%|██████████████████████████████████████████████▋                                                                       | 396/1000 [04:44<07:19,  1.37it/s][codecarbon INFO @ 13:18:32] Energy consumed for RAM : 0.003725 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:18:32] Energy consumed for all GPUs : 0.033293 kWh. Total GPU Power : 438.6672340149311 W
[codecarbon INFO @ 13:18:32] Energy consumed for all CPUs : 0.004798 kWh. Total CPU Power : 60.4537926781886 W
[codecarbon INFO @ 13:18:32] 0.041816 kWh of electricity used since the beginning.
 42%|█████████████████████████████████████████████████                                                                     | 416/1000 [04:59<07:05,  1.37it/s][codecarbon INFO @ 13:18:47] Energy consumed for RAM : 0.003921 kWh. RAM Power : 47.068857192993164 W
{'loss': 1.3629, 'grad_norm': 4.768548011779785, 'learning_rate': 6.7e-05, 'epoch': 0.8}
[codecarbon INFO @ 13:18:47] Energy consumed for all GPUs : 0.035127 kWh. Total GPU Power : 440.33660093280366 W
[codecarbon INFO @ 13:18:47] Energy consumed for all CPUs : 0.005050 kWh. Total CPU Power : 60.49327353639285 W
[codecarbon INFO @ 13:18:47] 0.044098 kWh of electricity used since the beginning.
 44%|███████████████████████████████████████████████████▌                                                                  | 437/1000 [05:14<06:43,  1.40it/s][codecarbon INFO @ 13:19:02] Energy consumed for RAM : 0.004117 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:19:02] Energy consumed for all GPUs : 0.036950 kWh. Total GPU Power : 437.7063118545578 W
[codecarbon INFO @ 13:19:02] Energy consumed for all CPUs : 0.005302 kWh. Total CPU Power : 60.46628916451894 W
[codecarbon INFO @ 13:19:02] 0.046369 kWh of electricity used since the beginning.
 46%|██████████████████████████████████████████████████████                                                                | 458/1000 [05:29<06:24,  1.41it/s][codecarbon INFO @ 13:19:17] Energy consumed for RAM : 0.004313 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:19:17] Energy consumed for all GPUs : 0.038822 kWh. Total GPU Power : 449.4692984611981 W
[codecarbon INFO @ 13:19:17] Energy consumed for all CPUs : 0.005555 kWh. Total CPU Power : 60.63296568787129 W
[codecarbon INFO @ 13:19:18] 0.048690 kWh of electricity used since the beginning.
 48%|████████████████████████████████████████████████████████▌                                                             | 479/1000 [05:44<06:13,  1.39it/s][codecarbon INFO @ 13:19:32] Energy consumed for RAM : 0.004509 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:19:32] Energy consumed for all GPUs : 0.040657 kWh. Total GPU Power : 440.4847956493303 W
[codecarbon INFO @ 13:19:32] Energy consumed for all CPUs : 0.005807 kWh. Total CPU Power : 60.49360583933964 W
[codecarbon INFO @ 13:19:32] 0.050972 kWh of electricity used since the beginning.
 50%|███████████████████████████████████████████████████████████                                                           | 500/1000 [05:59<05:56,  1.40it/s]
{'loss': 1.3546, 'grad_norm': 4.6572370529174805, 'learning_rate': 5.588888888888889e-05, 'epoch': 1.0}
***** Running Evaluation *****
  Num examples = 987
  Batch size = 2
                                                                                                                                                              [codecarbon INFO @ 13:19:47] Energy consumed for RAM : 0.004705 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:19:47] Energy consumed for all GPUs : 0.042501 kWh. Total GPU Power : 442.67886434565946 W              | 5/494 [00:00<00:39, 12.53it/s]
[codecarbon INFO @ 13:19:47] Energy consumed for all CPUs : 0.006059 kWh. Total CPU Power : 60.48435754053976 W
[codecarbon INFO @ 13:19:47] 0.053264 kWh of electricity used since the beginning.

[codecarbon INFO @ 13:20:03] Energy consumed for all GPUs : 0.044381 kWh. Total GPU Power : 451.368896730799 W              | 161/494 [00:15<00:32, 10.38it/s][codecarbon INFO @ 13:20:02] Energy consumed for RAM : 0.004901 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:20:03] Energy consumed for all CPUs : 0.006313 kWh. Total CPU Power : 60.86878393002638 W
[codecarbon INFO @ 13:20:03] 0.055594 kWh of electricity used since the beginning.
                                                                                                                                                              [codecarbon INFO @ 13:20:17] Energy consumed for RAM : 0.005097 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:20:17] Energy consumed for all GPUs : 0.046288 kWh. Total GPU Power : 457.9345465744545 W             | 317/494 [00:30<00:16, 10.48it/s]
[codecarbon INFO @ 13:20:18] Energy consumed for all CPUs : 0.006567 kWh. Total CPU Power : 61.0232239511582 W
[codecarbon INFO @ 13:20:18] 0.057952 kWh of electricity used since the beginning.
                                                                                                                                                              [codecarbon INFO @ 13:20:32] Energy consumed for RAM : 0.005293 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:20:32] Energy consumed for all GPUs : 0.048165 kWh. Total GPU Power : 450.71043693859184 W██████▉     | 473/494 [00:45<00:02, 10.44it/s]
[codecarbon INFO @ 13:20:33] Energy consumed for all CPUs : 0.006821 kWh. Total CPU Power : 60.91775136877247 W
[codecarbon INFO @ 13:20:33] 0.060279 kWh of electricity used since the beginning.
 50%|███████████████████████████████████████████████████████████                                                           | 500/1000 [06:46<05:56,  1.40it/s]Saving model checkpoint to ./tiny-llama-1.1b-chat-v1.0/checkpoint-500
loading configuration file config.json from cache at /home/sohampoddar/HDD2/hfcache/hub/models--TinyLlama--TinyLlama-1.1B-Chat-v1.0/snapshots/fe8a4ea1ffedaf415f4da2f062534de366a451e6/config.json
{'eval_loss': 1.704796552658081, 'eval_runtime': 47.3844, 'eval_samples_per_second': 20.83, 'eval_steps_per_second': 10.425, 'epoch': 1.0}
Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "head_dim": 64,
  "hidden_act": "silu",
  "hidden_size": 2048,
  "initializer_range": 0.02,
  "intermediate_size": 5632,
  "max_position_embeddings": 2048,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 22,
  "num_key_value_heads": 4,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 10000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.47.0.dev0",
  "use_cache": true,
  "vocab_size": 32000
}

tokenizer config file saved in ./tiny-llama-1.1b-chat-v1.0/checkpoint-500/tokenizer_config.json
Special tokens file saved in ./tiny-llama-1.1b-chat-v1.0/checkpoint-500/special_tokens_map.json
/home/sohampoddar/anaconda3/envs/dl/lib/python3.9/site-packages/torch/utils/checkpoint.py:464: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.4 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
 52%|████████████████████████████████████████████████████████████▊                                                         | 515/1000 [06:59<07:05,  1.14it/s][codecarbon INFO @ 13:20:47] Energy consumed for RAM : 0.005489 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:20:48] Energy consumed for all GPUs : 0.049983 kWh. Total GPU Power : 436.4247007002731 W
[codecarbon INFO @ 13:20:48] Energy consumed for all CPUs : 0.007072 kWh. Total CPU Power : 60.29885597132409 W
[codecarbon INFO @ 13:20:48] 0.062544 kWh of electricity used since the beginning.
 53%|███████████████████████████████████████████████████████████████                                                       | 534/1000 [07:14<06:03,  1.28it/s][codecarbon INFO @ 13:21:02] Energy consumed for RAM : 0.005685 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:21:03] Energy consumed for all GPUs : 0.051816 kWh. Total GPU Power : 439.93383020057803 W
[codecarbon INFO @ 13:21:03] Energy consumed for all CPUs : 0.007324 kWh. Total CPU Power : 60.33331136743288 W
[codecarbon INFO @ 13:21:03] 0.064824 kWh of electricity used since the beginning.
 55%|█████████████████████████████████████████████████████████████████▎                                                    | 554/1000 [07:29<05:35,  1.33it/s][codecarbon INFO @ 13:21:17] Energy consumed for RAM : 0.005881 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:21:18] Energy consumed for all GPUs : 0.053689 kWh. Total GPU Power : 450.3667235764593 W
[codecarbon INFO @ 13:21:18] Energy consumed for all CPUs : 0.007576 kWh. Total CPU Power : 60.58474596880756 W
[codecarbon INFO @ 13:21:18] 0.067145 kWh of electricity used since the beginning.
 57%|███████████████████████████████████████████████████████████████████▊                                                  | 575/1000 [07:44<05:03,  1.40it/s][codecarbon INFO @ 13:21:32] Energy consumed for RAM : 0.006077 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:21:33] Energy consumed for all GPUs : 0.055540 kWh. Total GPU Power : 444.3007312584601 W
[codecarbon INFO @ 13:21:33] Energy consumed for all CPUs : 0.007828 kWh. Total CPU Power : 60.5683591013824 W
[codecarbon INFO @ 13:21:33] 0.069444 kWh of electricity used since the beginning.
 60%|██████████████████████████████████████████████████████████████████████▎                                               | 596/1000 [07:59<04:48,  1.40it/s][codecarbon INFO @ 13:21:47] Energy consumed for RAM : 0.006273 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:21:48] Energy consumed for all GPUs : 0.057377 kWh. Total GPU Power : 441.18886305349 W
[codecarbon INFO @ 13:21:48] Energy consumed for all CPUs : 0.008081 kWh. Total CPU Power : 60.60834039872469 W
[codecarbon INFO @ 13:21:48] 0.071731 kWh of electricity used since the beginning.
 62%|████████████████████████████████████████████████████████████████████████▊                                             | 617/1000 [08:14<04:32,  1.40it/s][codecarbon INFO @ 13:22:02] Energy consumed for RAM : 0.006469 kWh. RAM Power : 47.068857192993164 W
{'loss': 1.2717, 'grad_norm': 4.880445957183838, 'learning_rate': 4.477777777777778e-05, 'epoch': 1.2}
[codecarbon INFO @ 13:22:03] Energy consumed for all GPUs : 0.059220 kWh. Total GPU Power : 442.63704433304264 W
[codecarbon INFO @ 13:22:03] Energy consumed for all CPUs : 0.008333 kWh. Total CPU Power : 60.60982930909145 W
[codecarbon INFO @ 13:22:03] 0.074022 kWh of electricity used since the beginning.
 64%|███████████████████████████████████████████████████████████████████████████▎                                          | 638/1000 [08:29<04:13,  1.43it/s][codecarbon INFO @ 13:22:18] Energy consumed for RAM : 0.006665 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:22:18] Energy consumed for all GPUs : 0.061095 kWh. Total GPU Power : 450.1400909086674 W
[codecarbon INFO @ 13:22:18] Energy consumed for all CPUs : 0.008586 kWh. Total CPU Power : 60.71686486491362 W
[codecarbon INFO @ 13:22:18] 0.076346 kWh of electricity used since the beginning.
 66%|█████████████████████████████████████████████████████████████████████████████▊                                        | 659/1000 [08:44<04:02,  1.41it/s][codecarbon INFO @ 13:22:33] Energy consumed for RAM : 0.006861 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:22:33] Energy consumed for all GPUs : 0.062940 kWh. Total GPU Power : 442.89473898345824 W
[codecarbon INFO @ 13:22:33] Energy consumed for all CPUs : 0.008838 kWh. Total CPU Power : 60.565811131353534 W
[codecarbon INFO @ 13:22:33] 0.078639 kWh of electricity used since the beginning.
 68%|████████████████████████████████████████████████████████████████████████████████▏                                     | 680/1000 [08:59<03:50,  1.39it/s][codecarbon INFO @ 13:22:48] Energy consumed for RAM : 0.007057 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:22:48] Energy consumed for all GPUs : 0.064784 kWh. Total GPU Power : 442.787047505294 W
[codecarbon INFO @ 13:22:48] Energy consumed for all CPUs : 0.009091 kWh. Total CPU Power : 60.54045668509826 W
[codecarbon INFO @ 13:22:48] 0.080932 kWh of electricity used since the beginning.
 70%|██████████████████████████████████████████████████████████████████████████████████▋                                   | 701/1000 [09:14<03:32,  1.40it/s][codecarbon INFO @ 13:23:03] Energy consumed for RAM : 0.007253 kWh. RAM Power : 47.068857192993164 W
{'loss': 1.2687, 'grad_norm': 5.023754119873047, 'learning_rate': 3.366666666666667e-05, 'epoch': 1.4}
[codecarbon INFO @ 13:23:03] Energy consumed for all GPUs : 0.066624 kWh. Total GPU Power : 441.6627684482467 W
[codecarbon INFO @ 13:23:03] Energy consumed for all CPUs : 0.009343 kWh. Total CPU Power : 60.62566096317487 W
[codecarbon INFO @ 13:23:03] 0.083220 kWh of electricity used since the beginning.
 72%|█████████████████████████████████████████████████████████████████████████████████████▏                                | 722/1000 [09:29<03:15,  1.42it/s][codecarbon INFO @ 13:23:18] Energy consumed for RAM : 0.007449 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:23:18] Energy consumed for all GPUs : 0.068496 kWh. Total GPU Power : 449.62249437667913 W
[codecarbon INFO @ 13:23:18] Energy consumed for all CPUs : 0.009596 kWh. Total CPU Power : 60.72243356571802 W
[codecarbon INFO @ 13:23:18] 0.085541 kWh of electricity used since the beginning.
 74%|███████████████████████████████████████████████████████████████████████████████████████▋                              | 743/1000 [09:44<03:02,  1.41it/s][codecarbon INFO @ 13:23:33] Energy consumed for RAM : 0.007645 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:23:33] Energy consumed for all GPUs : 0.070346 kWh. Total GPU Power : 443.9470342950767 W
[codecarbon INFO @ 13:23:33] Energy consumed for all CPUs : 0.009849 kWh. Total CPU Power : 60.70409572263116 W
[codecarbon INFO @ 13:23:33] 0.087839 kWh of electricity used since the beginning.
 76%|██████████████████████████████████████████████████████████████████████████████████████████▏                           | 764/1000 [09:59<02:48,  1.40it/s][codecarbon INFO @ 13:23:48] Energy consumed for RAM : 0.007841 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:23:48] Energy consumed for all GPUs : 0.072185 kWh. Total GPU Power : 441.5066341084901 W
[codecarbon INFO @ 13:23:48] Energy consumed for all CPUs : 0.010101 kWh. Total CPU Power : 60.54874134068996 W
[codecarbon INFO @ 13:23:48] 0.090127 kWh of electricity used since the beginning.
 78%|████████████████████████████████████████████████████████████████████████████████████████████▋                         | 785/1000 [10:14<02:34,  1.39it/s][codecarbon INFO @ 13:24:03] Energy consumed for RAM : 0.008037 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:24:03] Energy consumed for all GPUs : 0.074020 kWh. Total GPU Power : 440.6330444656343 W
[codecarbon INFO @ 13:24:03] Energy consumed for all CPUs : 0.010354 kWh. Total CPU Power : 60.528897737816195 W
[codecarbon INFO @ 13:24:03] 0.092410 kWh of electricity used since the beginning.
 81%|███████████████████████████████████████████████████████████████████████████████████████████████                       | 806/1000 [10:29<02:17,  1.41it/s][codecarbon INFO @ 13:24:18] Energy consumed for RAM : 0.008233 kWh. RAM Power : 47.068857192993164 W
{'loss': 1.2665, 'grad_norm': 5.741793632507324, 'learning_rate': 2.255555555555556e-05, 'epoch': 1.6}
[codecarbon INFO @ 13:24:18] Energy consumed for all GPUs : 0.075882 kWh. Total GPU Power : 446.9866023564522 W
[codecarbon INFO @ 13:24:18] Energy consumed for all CPUs : 0.010606 kWh. Total CPU Power : 60.55855611614537 W
[codecarbon INFO @ 13:24:18] 0.094721 kWh of electricity used since the beginning.
 83%|█████████████████████████████████████████████████████████████████████████████████████████████████▌                    | 827/1000 [10:44<02:02,  1.41it/s][codecarbon INFO @ 13:24:33] Energy consumed for RAM : 0.008429 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:24:33] Energy consumed for all GPUs : 0.077741 kWh. Total GPU Power : 446.2962696721516 W
[codecarbon INFO @ 13:24:33] Energy consumed for all CPUs : 0.010858 kWh. Total CPU Power : 60.596847129010214 W
[codecarbon INFO @ 13:24:33] 0.097028 kWh of electricity used since the beginning.
 85%|████████████████████████████████████████████████████████████████████████████████████████████████████                  | 848/1000 [10:59<01:48,  1.40it/s][codecarbon INFO @ 13:24:48] Energy consumed for RAM : 0.008625 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:24:48] Energy consumed for all GPUs : 0.079579 kWh. Total GPU Power : 441.27882605131373 W
[codecarbon INFO @ 13:24:48] Energy consumed for all CPUs : 0.011110 kWh. Total CPU Power : 60.51805884092757 W
[codecarbon INFO @ 13:24:48] 0.099314 kWh of electricity used since the beginning.
 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌               | 869/1000 [11:14<01:33,  1.40it/s][codecarbon INFO @ 13:25:03] Energy consumed for RAM : 0.008821 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:25:03] Energy consumed for all GPUs : 0.081432 kWh. Total GPU Power : 444.98226847904516 W
[codecarbon INFO @ 13:25:03] Energy consumed for all CPUs : 0.011362 kWh. Total CPU Power : 60.48658269955317 W
[codecarbon INFO @ 13:25:03] 0.101616 kWh of electricity used since the beginning.
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████             | 890/1000 [11:29<01:17,  1.42it/s][codecarbon INFO @ 13:25:18] Energy consumed for RAM : 0.009017 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:25:18] Energy consumed for all GPUs : 0.083287 kWh. Total GPU Power : 445.32912126787016 W
[codecarbon INFO @ 13:25:18] Energy consumed for all CPUs : 0.011615 kWh. Total CPU Power : 60.65972692644599 W
[codecarbon INFO @ 13:25:18] 0.103920 kWh of electricity used since the beginning.
 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▍          | 911/1000 [11:44<01:02,  1.41it/s][codecarbon INFO @ 13:25:33] Energy consumed for RAM : 0.009213 kWh. RAM Power : 47.068857192993164 W
{'loss': 1.2685, 'grad_norm': 6.289984226226807, 'learning_rate': 1.1444444444444446e-05, 'epoch': 1.8}
[codecarbon INFO @ 13:25:33] Energy consumed for all GPUs : 0.085013 kWh. Total GPU Power : 414.28334057752284 W
[codecarbon INFO @ 13:25:33] Energy consumed for all CPUs : 0.011868 kWh. Total CPU Power : 60.76812361667897 W
[codecarbon INFO @ 13:25:33] 0.106095 kWh of electricity used since the beginning.
 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 933/1000 [11:59<00:47,  1.41it/s][codecarbon INFO @ 13:25:48] Energy consumed for RAM : 0.009409 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:25:48] Energy consumed for all GPUs : 0.086689 kWh. Total GPU Power : 402.37122631562175 W
[codecarbon INFO @ 13:25:48] Energy consumed for all CPUs : 0.012121 kWh. Total CPU Power : 60.69951704314586 W
[codecarbon INFO @ 13:25:48] 0.108219 kWh of electricity used since the beginning.
 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌     | 954/1000 [12:14<00:33,  1.39it/s][codecarbon INFO @ 13:26:03] Energy consumed for RAM : 0.009605 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:26:03] Energy consumed for all GPUs : 0.088371 kWh. Total GPU Power : 403.92507714225434 W
[codecarbon INFO @ 13:26:03] Energy consumed for all CPUs : 0.012374 kWh. Total CPU Power : 60.723040811589996 W
[codecarbon INFO @ 13:26:03] 0.110350 kWh of electricity used since the beginning.
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 975/1000 [12:29<00:17,  1.40it/s][codecarbon INFO @ 13:26:18] Energy consumed for RAM : 0.009801 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:26:18] Energy consumed for all GPUs : 0.090059 kWh. Total GPU Power : 405.2798580555188 W
[codecarbon INFO @ 13:26:18] Energy consumed for all CPUs : 0.012627 kWh. Total CPU Power : 60.72870839047012 W
[codecarbon INFO @ 13:26:18] 0.112487 kWh of electricity used since the beginning.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌| 996/1000 [12:44<00:02,  1.40it/s][codecarbon INFO @ 13:26:33] Energy consumed for RAM : 0.009997 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:26:33] Energy consumed for all GPUs : 0.091749 kWh. Total GPU Power : 405.6755540790273 W
[codecarbon INFO @ 13:26:33] Energy consumed for all CPUs : 0.012880 kWh. Total CPU Power : 60.737379085805216 W
[codecarbon INFO @ 13:26:33] 0.114626 kWh of electricity used since the beginning.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [12:47<00:00,  1.40it/s]Saving model checkpoint to ./tiny-llama-1.1b-chat-v1.0/checkpoint-1000
{'loss': 1.2664, 'grad_norm': 5.397653579711914, 'learning_rate': 3.3333333333333335e-07, 'epoch': 2.0}
loading configuration file config.json from cache at /home/sohampoddar/HDD2/hfcache/hub/models--TinyLlama--TinyLlama-1.1B-Chat-v1.0/snapshots/fe8a4ea1ffedaf415f4da2f062534de366a451e6/config.json
Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "head_dim": 64,
  "hidden_act": "silu",
  "hidden_size": 2048,
  "initializer_range": 0.02,
  "intermediate_size": 5632,
  "max_position_embeddings": 2048,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 22,
  "num_key_value_heads": 4,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 10000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.47.0.dev0",
  "use_cache": true,
  "vocab_size": 32000
}

tokenizer config file saved in ./tiny-llama-1.1b-chat-v1.0/checkpoint-1000/tokenizer_config.json
Special tokens file saved in ./tiny-llama-1.1b-chat-v1.0/checkpoint-1000/special_tokens_map.json

***** Running Evaluation *****
  Num examples = 987
  Batch size = 2
                                                                                                                                                              [codecarbon INFO @ 13:26:48] Energy consumed for RAM : 0.010193 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:26:48] Energy consumed for all GPUs : 0.093444 kWh. Total GPU Power : 407.13810839212823 W            | 117/494 [00:11<00:36, 10.34it/s]
[codecarbon INFO @ 13:26:48] Energy consumed for all CPUs : 0.013134 kWh. Total CPU Power : 60.911685967279 W
[codecarbon INFO @ 13:26:48] 0.116772 kWh of electricity used since the beginning.
                                                                                                                                                              [codecarbon INFO @ 13:27:03] Energy consumed for RAM : 0.010389 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:27:03] Energy consumed for all GPUs : 0.095257 kWh. Total GPU Power : 435.1218804252671 W             | 273/494 [00:26<00:21, 10.21it/s]
[codecarbon INFO @ 13:27:03] Energy consumed for all CPUs : 0.013386 kWh. Total CPU Power : 60.352521961439216 W
[codecarbon INFO @ 13:27:03] 0.119031 kWh of electricity used since the beginning.
                                                                                                                                                              [codecarbon INFO @ 13:27:18] Energy consumed for RAM : 0.010585 kWh. RAM Power : 47.068857192993164 W
[codecarbon INFO @ 13:27:18] Energy consumed for all GPUs : 0.097120 kWh. Total GPU Power : 447.39275968813325 W            | 427/494 [00:41<00:06, 10.21it/s]
[codecarbon INFO @ 13:27:18] Energy consumed for all CPUs : 0.013639 kWh. Total CPU Power : 60.753605646064486 W
[codecarbon INFO @ 13:27:18] 0.121344 kWh of electricity used since the beginning.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [13:36<00:00,  1.40it/s]Saving model checkpoint to ./tiny-llama-1.1b-chat-v1.0/checkpoint-1000
loading configuration file config.json from cache at /home/sohampoddar/HDD2/hfcache/hub/models--TinyLlama--TinyLlama-1.1B-Chat-v1.0/snapshots/fe8a4ea1ffedaf415f4da2f062534de366a451e6/config.json
{'eval_loss': 1.7250041961669922, 'eval_runtime': 47.8855, 'eval_samples_per_second': 20.612, 'eval_steps_per_second': 10.316, 'epoch': 2.0}
Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "head_dim": 64,
  "hidden_act": "silu",
  "hidden_size": 2048,
  "initializer_range": 0.02,
  "intermediate_size": 5632,
  "max_position_embeddings": 2048,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 22,
  "num_key_value_heads": 4,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 10000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.47.0.dev0",
  "use_cache": true,
  "vocab_size": 32000
}

tokenizer config file saved in ./tiny-llama-1.1b-chat-v1.0/checkpoint-1000/tokenizer_config.json
Special tokens file saved in ./tiny-llama-1.1b-chat-v1.0/checkpoint-1000/special_tokens_map.json


Training completed. Do not forget to share your model on huggingface.co/models =)


100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [13:37<00:00,  1.40it/s][codecarbon INFO @ 13:27:25] Energy consumed for RAM : 0.010682 kWh. RAM Power : 47.068857192993164 W
{'train_runtime': 819.7417, 'train_samples_per_second': 4.88, 'train_steps_per_second': 1.22, 'train_loss': 1.3684440841674805, 'epoch': 2.0}
[codecarbon INFO @ 13:27:25] Energy consumed for all GPUs : 0.098015 kWh. Total GPU Power : 434.5031239738955 W
[codecarbon INFO @ 13:27:25] Energy consumed for all CPUs : 0.013763 kWh. Total CPU Power : 60.34175393050066 W
[codecarbon INFO @ 13:27:25] 0.122460 kWh of electricity used since the beginning.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1000/1000 [13:37<00:00,  1.22it/s]
Saving model checkpoint to ./tiny-llama-1.1b-chat-v1.0
loading configuration file config.json from cache at /home/sohampoddar/HDD2/hfcache/hub/models--TinyLlama--TinyLlama-1.1B-Chat-v1.0/snapshots/fe8a4ea1ffedaf415f4da2f062534de366a451e6/config.json
Model config LlamaConfig {
  "architectures": [
    "LlamaForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "head_dim": 64,
  "hidden_act": "silu",
  "hidden_size": 2048,
  "initializer_range": 0.02,
  "intermediate_size": 5632,
  "max_position_embeddings": 2048,
  "mlp_bias": false,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 22,
  "num_key_value_heads": 4,
  "pretraining_tp": 1,
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_theta": 10000.0,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.47.0.dev0",
  "use_cache": true,
  "vocab_size": 32000
}

tokenizer config file saved in ./tiny-llama-1.1b-chat-v1.0/tokenizer_config.json
Special tokens file saved in ./tiny-llama-1.1b-chat-v1.0/special_tokens_map.json
